!function(a,b,c){"use strict";var d="jollyany_package_"+Math.random().toString(36).substring(7),e=a("<div/>",{class:"progress"}),f=a("<div/>",{class:"progress-bar progress-bar-striped progress-bar-animated",role:"progressbar","aria-valuenow":"0","aria-valuemin":"0","aria-valuemax":"100",style:"width: 0%"}),g=a("<div/>",{class:"text-muted"});e.append(f);var h=function(){f.attr("aria-valuenow",0).css("width","0%"),f.addClass("progress-bar-animated").addClass("progress-bar-striped")},i=function(b,c,d){a.ajax({url:"index.php?t="+Math.random().toString(36).substring(7),type:"POST",data:b,beforeSend:function(){g.html('<i class="far fa-compass fa-spin"></i> Downloading Package...')},success:function(a){"success"==a.status?(f.attr("aria-valuenow",100*b.step/a.pathcount).css("width",100*b.step/a.pathcount+"%"),a.pathcount<=b.step?(g.text("Package download completed!"),b.archive=a.archive,b.jollyany="unzip_package",j(b,c,d)):(b.step++,i(b,c,d))):(d.find(".dialogDebug").text(a.message),c.find("i").remove(),c.removeAttr("disabled",""))}})},j=function(c,d,e){a.ajax({url:"index.php?t="+Math.random().toString(36).substring(7),type:"POST",data:c,beforeSend:function(){g.html('<i class="far fa-compass fa-spin"></i> Unzip Package...')},success:function(a){"success"==a.status?(g.text("Package unzip completed!"),c.package=a.package,g.html('<i class="far fa-compass fa-spin"></i> Redirect to install page...'),b.onbeforeunload=null,b.location.href=a.url_root):(e.find(".dialogDebug").text(a.message),d.find("i").remove(),d.removeAttr("disabled",""))}})},k=function(b,c){a.ajax({url:"index.php?t="+Math.random().toString(36).substring(7),type:"POST",data:b,beforeSend:function(){c.find(".extensions-container").html('<i class="far fa-compass fa-spin"></i> Get package data...')},success:function(b){if("success"==b.status){var d=a.parseJSON(b.data),e=c.find(".extensions-container");e.empty();for(var f=0;f<d.length;f++){var g=a("<div/>",{class:"custom-control custom-checkbox mt-3"}),h=a("<input/>",{class:"custom-control-input extension-item",type:"checkbox",id:"extension-"+f,value:f}),i=a("<label/>",{class:"custom-control-label",for:"extension-"+f});i.append("<h6>"+d[f].name+"</h6>"),g.append(h).append(i),e.append(g)}}else c.find(".dialogDebug").text(b.message)}})},l=function(b,c,d){a.ajax({url:"index.php?t="+Math.random().toString(36).substring(7),type:"POST",data:b,beforeSend:function(){g.html('<i class="far fa-compass fa-spin"></i> Get package data...')},success:function(e){"success"==e.status?(b.jollyany="install_package",m(b,c,d,0,a.parseJSON(e.data))):(d.find(".dialogDebug").text(e.message),c.find("i").remove(),c.removeAttr("disabled",""))}})},m=function(b,c,d,e,h){if(e<h.length){var i=h[e];b.extension=JSON.stringify(i),a.ajax({url:"index.php?t="+Math.random().toString(36).substring(7),type:"POST",data:b,beforeSend:function(){g.html('<i class="far fa-compass fa-spin"></i> Installing: '+i.name+"...")},success:function(a){"success"==a.status?(f.attr("aria-valuenow",100*(e+1)/h.length).css("width",100*(e+1)/h.length+"%"),g.html('<i class="far fa-smile"></i> '+i.name+" installed!"),m(b,c,d,e+1,h)):(d.find(".dialogDebug").append("<br />+"+a.message),c.find("i").remove(),c.removeAttr("disabled",""))}})}else c.find("i").remove(),c.removeAttr("disabled",""),f.removeClass("progress-bar-animated").removeClass("progress-bar-striped"),g.html('<i class="far fa-smile"></i> All extensions has installed!')};a(document).ready(function(){var c,f,j=null,m=a("#jollyany-theme-activate"),n=a("#jollyany-form-data-json");if(n.length)try{j=JSON.parse(n.html()),n.html("")}catch(b){}if(null!=j){var o=a("<html>"),p=a("<head>"),q=a("<body>");o.append(p).append(q);var r=a("<link>").attr({rel:"stylesheet",href:j.api+"/components/com_tz_envato_license/css/style.css"});p.append(r),p.append("<title>Jollyany &ndash; Product Activation</title>");var s=a('<form style="display:none;">').attr({action:j.api+"/index.php?option=com_tz_envato_license&view=activation",method:"POST",enctype:"multipart/form-data",id:"jollyany-activate-product-form",acceptCharset:"ISO-8859-1"}).append('<div class="jollyany-activation-loading"><div class="jollyany-activation-loading-content"><h2>Please wait&hellip;</h2><p>You will be redirected to Envato website in few seconds</p></div></div>');for(var t in j)a("<input>").attr({type:"hidden",name:t,value:j[t]}).appendTo(s);q.append(s);var u=function(){var a=b.navigator.userAgent,c=a.indexOf("MSIE ");if(c>0)return parseInt(a.substring(c+5,a.indexOf(".",c)),10);if(a.indexOf("Trident/")>0){var d=a.indexOf("rv:");return parseInt(a.substring(d+3,a.indexOf(".",d)),10)}var e=a.indexOf("Edge/");return e>0&&parseInt(a.substring(e+5,a.indexOf(".",e)),10)}();u&&(s.attr("target","jollyanyProductActivationWindow"),s.appendTo(a(document.body))),m.on("click",function(d){d.preventDefault();var e=o.clone(),g=e.find("form"),h=u?550:350,i=screen.width/2-300,j=screen.height/2-h/2;c=b.open("","jollyanyProductActivationWindow","width=600, height="+h+", top="+j+", left="+i),u?s.submit():a(c.document.body).append(e),c?u||e.find("link").on("load",function(){g.show(),setTimeout(function(){h=800,c.resizeTo(600,h),c.moveBy(0,-200),g.submit()},1100)}):alert("Your browser is blocking popups, activation process cannot continue!"),b.clearInterval(f),f=setInterval(function(){if(u)try{c.parent}catch(c){b.clearInterval(f),b.location.reload()}else c.parent||(b.clearInterval(f),b.location.reload())},300)})}if(a(".delete-template-activation").on("click",function(c){var d=a(this).data("token"),e=a(this);if(confirm("Are you sure you want to delete template activation?")){var f={};return f[d]=1,f.jollyany="deactivate",f.option="com_ajax",a.ajax({url:"index.php?t="+Math.random().toString(36).substring(7),type:"POST",data:f,beforeSend:function(){e.find("i").addClass("fa-spin")},success:function(a){e.find("i").removeClass("fa-spin"),"success"==a.status?b.location.reload():e.appendText(JSON.stringify(a))}}),1}}),a("#astroid-form-fieldset-section-dashboard .astroid-form-fieldset-section").length){a("#astroid-form-fieldset-section-dashboard .astroid-form-fieldset-section").find(".form-group > .row > *[class^='col-sm-']").attr("class","col-12 col-sm-12")}if(a("#astroid-form-fieldset-section-presets .astroid-form-fieldset-section").length){a("#astroid-form-fieldset-section-presets .astroid-form-fieldset-section").find(".form-group > .row > *[class^='col-sm-']").attr("class","col-12 col-sm-12"),a("#jollyany-save-preset").on("click",function(c){return c.preventDefault(),""===a("#jollyany-preset-name").val()?(alert("Please insert name of preset!"),a("#jollyany-preset-name").focus(),!1):(a("#jollyany-preset").val(1),a("#astroid-form").submit(),b.onbeforeunload=null,b.location.reload(),!1)}),a(".jollyany-load-preset").on("click",function(b){b.preventDefault();var c=a(this).data("token"),d=a(this);if(confirm("Your current configure will be lost and overwritten by new data. Are you sure?")){var e={};e[c]=1,e.name=d.data("name"),e.template=TEMPLATE_NAME,e.jollyany="loadpreset",e.option="com_ajax",a.ajax({url:"index.php?t="+Math.random().toString(36).substring(7),type:"POST",data:e,beforeSend:function(){d.attr("disabled","disabled"),d.prepend('<i class="fas fa-spinner fa-pulse"></i>')},success:function(a){if(d.removeAttr("disabled",""),d.find("i").remove(),"success"==a.status){var b=Admin.checkUploadedSettings(a.data);!1!==b&&Admin.saveImportedSettings(b)}}})}return 1}),a(".jollyany-del-preset").on("click",function(c){var d=a(this).data("token"),e=a(this);if(confirm("This preset will be deleted! Are you sure?")){var f={};f[d]=1,f.name=e.data("name"),f.template=TEMPLATE_NAME,f.jollyany="removepreset",f.option="com_ajax",a.ajax({url:"index.php?t="+Math.random().toString(36).substring(7),type:"POST",data:f,success:function(a){b.onbeforeunload=null,b.location.reload()}})}return 1})}if(a("#astroid-form-fieldset-section-jollyanyimport .astroid-form-fieldset-section").length){var v=a("#astroid-form-fieldset-section-jollyanyimport .astroid-form-fieldset-section"),w=a("#install-package-dialog"),x=a("#jollyany-dialog-template");v.find("*[class^='col-sm-']").attr("class","col-12 col-sm-12"),a(".intall-package").on("click",function(b){b.preventDefault();var c=a(this);if(0==c.data("status"))alert("Your license is invalid or expired! You need buy or renew your license to use this premium feature!");else{w.html(x.html()),w.find(".package-name").text(c.data("name")),w.find(".install-action").attr("data-file",c.data("file")),w.find("h5, small").each(function(b,d){var e=a(this).text();e=e.replace("##templatename##",c.data("name")),a(this).text(e)});var f={};f.install_code=c.data("file"),f.option="com_ajax",f.jollyany="get_extensions_data",f[c.data("token")]=1,k(f,w),w.modal("show"),a(".install-action").on("click",function(b){var c={},f=a(this),j=new Array;if(w.find(".extension-item").each(function(b,c){a(c).is(":checked")&&j.push(a(c).val())}),c[f.data("token")]=1,c.option="com_ajax",c["extension-package"]=j,c["template-package"]=a("#template-package:checked").length,c["demo-data-package"]=a("#demo-data-package:checked").length,c.file_name=d,c.step=1,c.install_code=f.data("file"),a("#demo-data-package:checked").length){if(!confirm("Your current data will be lost and overwritten by new content. Are you sure?"))return 1;c.jollyany="download_package",f.attr("disabled","disabled"),f.prepend('<i class="fas fa-spinner fa-pulse"></i>'),w.find(".dialogDebug").html(""),h(),w.find(".dialogDebug").append(e).append(g),g.text('<i class="far fa-compass fa-spin"></i> Preparing to download package...'),i(c,f,w)}else c.jollyany="get_package_data",f.attr("disabled","disabled"),f.prepend('<i class="fas fa-spinner fa-pulse"></i>'),w.find(".dialogDebug").html(""),h(),w.find(".dialogDebug").append(e).append(g),g.text('<i class="far fa-compass fa-spin"></i> Preparing to download package...'),l(c,f,w);return 1})}}),w.on("hidden.bs.modal",function(b){a(this).empty()})}})}(jQuery,window);